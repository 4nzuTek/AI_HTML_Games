# Tarkov風インベントリシステム 仕様書

## 概要
HTML5、CSS3、JavaScriptを使用したTarkov風のインベントリシステムです。プレイヤーはグリッドベースのインベントリにアイテムを配置し、ドラッグ&ドロップでアイテムを移動・回転させることができます。

## ゲーム情報
- **ゲーム名**: Tarkov風インベントリシステム
- **開発言語**: HTML5, CSS3, JavaScript
- **インベントリサイズ**: 10×10グリッド
- **ゲームタイプ**: インベントリ管理システム

## システム構成

### インベントリグリッド
- **サイズ**: 10×10セル
- **セルサイズ**: 40×40ピクセル
- **グリッドギャップ**: 1ピクセル
- **背景色**: #444（ダークグレー）
- **境界線**: #666（グレー）

### アイテムパレット
- **位置**: インベントリグリッドの右側
- **背景色**: #333（ダークグレー）
- **境界線**: #555（グレー）
- **最小幅**: 200ピクセル

## アイテムシステム

### アイテムタイプ
1. **医療キット** (medkit)
   - サイズ: 2×2
   - 色: 緑系 (#2a5a2a)
   - 初期位置: (0, 0)

2. **弾薬** (ammo)
   - サイズ: 1×1
   - 色: 緑系 (#2a5a2a)
   - 初期位置: (2, 2)

3. **食料** (food)
   - サイズ: 1×2
   - 色: 緑系 (#2a5a2a)
   - 初期位置: (0, 3)

4. **武器** (weapon)
   - サイズ: 3×2
   - 色: 緑系 (#2a5a2a)
   - パレットからの追加可能

5. **バックパック** (backpack)
   - サイズ: 4×2
   - 色: 緑系 (#2a5a2a)
   - パレットからの追加可能

### アイテムの視覚的表現
- **配置済みアイテム**: 緑系背景 (#2a5a2a)、境界線 (#4a7a4a)
- **ホバー効果**: 背景色が明るくなる (#3a6a3a)
- **配置不可能**: 赤系背景 (#7a2a2a)、境界線 (#aa4444)
- **シャドウアイテム**: 50%透明度、配置可能/不可能で色分け

## 操作方法

### ドラッグ&ドロップ
- **パレットからインベントリへ**: アイテムをクリック&ドラッグ
- **インベントリ内移動**: 配置済みアイテムをドラッグ
- **ドロップ判定**: グリッドの中心位置で判定

### アイテム回転
- **回転キー**: Rキー
- **回転条件**: ドラッグ中のみ
- **回転効果**: 幅と高さを入れ替え
- **回転時の位置調整**: 中心位置を維持

### マウス操作
- **左クリック**: アイテム選択・ドラッグ開始
- **ドラッグ**: アイテム移動
- **ドロップ**: アイテム配置

## ゲームルール

### アイテム配置ルール
1. **境界チェック**: アイテムがグリッド外にはみ出さない
2. **重複チェック**: 他のアイテムと重複しない
3. **サイズ制限**: アイテムサイズに応じた占有領域

### 配置判定システム
```javascript
canPlaceItem(row, col, size, ignoreItemId = null)
```
- **row, col**: 配置位置（左上基準）
- **size**: アイテムサイズ（例: "2x2"）
- **ignoreItemId**: 移動時に自身を除外するID

### 勝利条件
- 特定の勝利条件はなし（インベントリ管理システム）

## 技術仕様

### グリッドシステム
- **座標系**: 左上が(0,0)
- **セル計算**: `col * (cellSize + gridGap)`
- **位置計算**: 中心位置を基準とした配置

### ドラッグシステム
- **自前実装**: HTML5 Drag & Drop API + カスタム実装
- **座標変換**: マウス座標 → グリッド座標 → ピクセル座標
- **リアルタイム更新**: ドラッグ中の視覚的フィードバック

### 回転システム
```javascript
rotateCurrentItem()
```
- **サイズ交換**: width ↔ height
- **位置再計算**: 中心位置を維持
- **視覚的更新**: ドラッグ要素とシャドウ要素の同時更新

### シャドウシステム
```javascript
showShadowItem(row, col, sizeOverride, ignoreItemId)
```
- **配置可能**: 緑系シャドウ
- **配置不可能**: 赤系シャドウ
- **リアルタイム更新**: ドラッグ中に継続更新

## ファイル構成
```
Test01_20250712/
├── index.html          # メインHTMLファイル
├── css/
│   └── style.css      # スタイルシート
├── js/
│   └── inventory.js   # インベントリシステムロジック
├── docs/
│   └── ゲーム仕様書.md # この仕様書
├── images/            # 画像ファイル（未使用）
├── audio/             # 音声ファイル（未使用）
└── assets/            # その他アセット（未使用）
```

## クラス構造

### InventorySystem クラス
```javascript
class InventorySystem {
    constructor() {
        this.gridSize = 10;
        this.cellSize = 40;
        this.gridGap = 1;
        this.inventory = [];
        this.placedItems = new Map();
        this.draggedItem = null;
        this.dragOffset = { x: 0, y: 0 };
        this.shadowItem = null;
        this.isDragging = false;
        this.currentDragItem = null;
        this.currentDragElement = null;
    }
}
```

### 主要メソッド
- `createGrid()`: グリッド生成
- `setupDragAndDrop()`: ドラッグ&ドロップ設定
- `setupPaletteDrag()`: パレットドラッグ設定
- `setupRotationHandler()`: 回転機能設定
- `placeItem(row, col, item)`: アイテム配置
- `moveItem(itemElement, newRow, newCol)`: アイテム移動
- `rotateCurrentItem()`: アイテム回転
- `canPlaceItem(row, col, size, ignoreItemId)`: 配置判定

## スタイルシステム

### カラーパレット
- **背景色**: #1a1a1a（ダーク）
- **グリッド背景**: #333（ダークグレー）
- **セル背景**: #444（グレー）
- **アイテム背景**: #2a5a2a（緑）
- **エラー色**: #7a2a2a（赤）
- **アクセント色**: #ffd700（ゴールド）

### レスポンシブデザイン
- **コンテナ最大幅**: 1200px
- **中央配置**: flexbox使用
- **ギャップ**: 30px（インベントリとパレット間）

## 今後の拡張可能性
- アイテム画像の追加
- 音響効果の実装
- アイテムスタック機能
- インベントリの保存/読み込み機能
- 複数インベントリ対応
- アイテムの詳細情報表示
- 検索・フィルタ機能
- モバイル対応（タッチ操作）
- アイテムの重さ・価値システム
- アイテムの耐久度システム 